<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Добавить пароль</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>Добавить новый пароль</h1>

    <form method="POST" id="passwordForm">
        {{ form.hidden_tag() }}

        <div class="form-group">
            {{ form.name.label }}
            {{ form.name(id="serviceName") }}
        </div>

        <div class="form-group">
            {{ form.username.label }}
            {{ form.username(id="serviceUsername") }}
        </div>

        <div class="form-group">
            {{ form.password.label }}
            <div style="display: flex; align-items: center; gap: 10px;">
                {{ form.password(id="passwordField", style="flex-grow: 1;") }}
                <button type="button" id="generateBtn" style="padding: 8px 15px;">Сгенерировать</button>
            </div>
            <div style="margin-top: 10px;">
                <label>
                    Длина:
                    <input type="number" id="passLength" min="6" max="32" value="12" style="width: 50px;">
                </label>
                <label style="margin-left: 15px;">
                    <input type="checkbox" id="includeSpecial"> Спецсимволы
                </label>
            </div>
        </div>

        <div class="form-group">
            {{ form.submit }}
        </div>
    </form>

    <a href="{{ url_for('personal_main', user=session['user']) }}">← Назад к списку</a>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Находим кнопку и поле пароля
            const generateBtn = document.getElementById('generateBtn');
            const passwordField = document.getElementById('passwordField');

            // Вешаем обработчик на кнопку
            generateBtn.addEventListener('click', function() {
                const length = parseInt(document.getElementById('passLength').value);
                const includeSpecial = document.getElementById('includeSpecial').checked;

                // Генерируем пароль
                const password = generatePassword(length, includeSpecial);

                // Вставляем пароль в поле
                passwordField.value = password;
            });

            // Функция генерации пароля
            function generatePassword(length, useSpecial) {
                let chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
                if (useSpecial) chars += '!@#$%^&*()_+-=[]{}|;:,.<>?';

                let password = '';
                for (let i = 0; i < length; i++) {
                    password += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                return password;
            }
        });
    </script>
</body>
</html>